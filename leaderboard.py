import streamlit as st
import pandas as pd
import datetime

# ğŸš€ í˜ì´ì§€ ê¸°ë³¸ ì„¤ì • (ê°€ì¥ ë¨¼ì € ì‹¤í–‰ë˜ì–´ì•¼ í•©ë‹ˆë‹¤)
st.set_page_config(
    page_title="HW 01 ë¦¬ë”ë³´ë“œ",
    page_icon="ğŸ†",
    layout="wide"  # í˜ì´ì§€ë¥¼ ë„“ê²Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
)

# --- ë°ì´í„° ê´€ë¦¬ ---

def get_leaderboard_data():
    """
    í•™ìƒ ID ë° ì ìˆ˜ ë°ì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
    (ë°ì´í„°ê°€ ê¸¸ì–´ì„œ í•¨ìˆ˜ë¡œ ë¶„ë¦¬í–ˆìŠµë‹ˆë‹¤.)
    """
    # í•™ìƒ ID ë¦¬ìŠ¤íŠ¸ ğŸ§‘â€ğŸ“
    student_ids = [
        20231837, 20211402, 20211733, 20231851, 20231852, 20231846, 20231831, 20231843,
        20230320, 20231854, 20220378, 20211168, 20210261, 20200025, 20231218, 20241901,
        20221593, 20201227, 20241909, 20211166, 20241584, 20200307, 20232241, 20220154,
        20231834, 20231842, 20211352, 20211188, 20181599, 20201608, 20201625, 20191347,
        20221931, 20201396, 20221995, 20221201, 20201638, 20200595, 20201607, 20211014,
        20201663, 20221300, 20231838, 20191666, 20191579
    ]
    
    # Accuracy ì ìˆ˜ (ì˜ˆì‹œ ë°ì´í„°) ğŸ¯
    scores_accuracy_dict = {
        20231837: 0, 20211402: 0.9458, 20211733: 0.9083, 20231851: 0, 20231852: 0,
        20231846: 0, 20231831: 0, 20231843: 0.9500, 20230320: 0, 20231854: 0,
        20220378: 0.9403, 20211168: 0.9361, 20210261: 0.9167, 20200025: 0.9653, 20231218: 0,
        20241901: 0.9139, 20221593: 0, 20201227: 0, 20241909: 0.9458, 20211166: 0.9236,
        20241584: 0, 20200307: 0, 20232241: 0, 20220154: 0, 20231834: 0,
        20231842: 0.9292, 20211352: 0, 20211188: 0, 20181599: 0, 20201608: 0,
        20201625: 0, 20191347: 0, 20221931: 0, 20201396: 0.9278, 20221995: 0,
        20221201: 0.9014, 20201638: 0.9542, 20200595: 0.9458, 20201607: 0, 20211014: 0,
        20201663: 0, 20221300: 0, 20231838: 0, 20191666: 0.9514, 20191579: 0
    }
    
    # F1 ì ìˆ˜ (ì˜ˆì‹œ ë°ì´í„°) ğŸ“‰
    scores_f1_dict = {
        20231837: 0, 20211402: 0.9417, 20211733: 0.9061, 20231851: 0, 20231852: 0,
        20231846: 0, 20231831: 0, 20231843: 0.9472, 20230320: 0, 20231854: 0,
        20220378: 0.9398, 20211168: 0.9338, 20210261: 0.9144, 20200025: 0.9651, 20231218: 0,
        20241901: 0.9096, 20221593: 0, 20201227: 0, 20241909: 0.9420, 20211166: 0.9205,
        20241584: 0, 20200307: 0, 20232241: 0, 20220154: 0, 20231834: 0,
        20231842: 0.9278, 20211352: 0, 20211188: 0, 20181599: 0, 20201608: 0,
        20201625: 0, 20191347: 0, 20221931: 0, 20201396: 0.9240, 20221995: 0,
        20221201: 0.8967, 20201638: 0.9542, 20200595: 0.9455, 20201607: 0, 20211014: 0,
        20201663: 0, 20221300: 0, 20231838: 0, 20191666: 0.9497, 20191579: 0
    }    

    
    return student_ids, scores_accuracy_dict, scores_f1_dict

# --- DataFrame ìƒì„± í•¨ìˆ˜ ---

def create_leaderboard_df(student_ids, f1_dict, acc_dict, ascending=False):
    """ë¦¬ë”ë³´ë“œ ìˆœìœ„ê°€ ë§¤ê²¨ì§„ DataFrameì„ ìƒì„±í•©ë‹ˆë‹¤."""
    
    df = pd.DataFrame({'Student_ID': student_ids})
    df['f1'] = df['Student_ID'].map(f1_dict)
    df['acc'] = df['Student_ID'].map(acc_dict)

    # ì ìˆ˜ê°€ ì—†ëŠ” í•™ìƒì€ ë¦¬ë”ë³´ë“œì—ì„œ ì œì™¸
    df = df.dropna(subset=['f1'])
    
    # ì ìˆ˜ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬
    df = df.sort_values(by=['f1', 'acc'], ascending=[False, False]).reset_index(drop=True)
    
    # ìˆœìœ„(Rank)ë¥¼ 1ë¶€í„° ì‹œì‘í•˜ë„ë¡ ì„¤ì •
    df.index += 1
    df.index.name = 'Rank'
    
    # Student_IDë¥¼ ë¬¸ìì—´ë¡œ ë³€ê²½ (í‘œì‹œìš©)
    df['Student_ID'] = df['Student_ID'].astype(str)
    
    return df

# --- Streamlit ì•± ë©”ì¸ ë¡œì§ ---

def main():
    # --- 1. íƒ€ì´í‹€ ë° ì„¤ëª… ---
    st.title("ğŸ† HW 02 Leaderboard")
    st.markdown("ë³¸ ë¦¬ë”ë³´ë“œëŠ” CNN ëª¨ë¸ì˜ **My Method ì„±ëŠ¥**ì„ í‰ê°€í•˜ì—¬ ìˆœìœ„ë¥¼ ë§¤ê¸´ ê²ƒì…ë‹ˆë‹¤.")

    # --- 2. ì—…ë°ì´íŠ¸ ì‹œê°„ í‘œì‹œ ---
    now = datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S")
    st.info(f"ğŸ—“ï¸ ë¦¬ë”ë³´ë“œëŠ” ë§¤ì¼ ì˜¤ì „ ì—…ë°ì´íŠ¸ ë©ë‹ˆë‹¤. (ì—…ë°ì´íŠ¸ ì‹œê°„: {now})")

    # --- 3. ë°ì´í„° ë¡œë“œ ---
    student_ids, scores_acc, scores_f1 = get_leaderboard_data()

    # --- 4. Accuracy ë¦¬ë”ë³´ë“œ ---
    st.divider()  # ì‹œê°ì  êµ¬ë¶„ì„ 
    
    st.subheader("ğŸ¯ f1 (ì´ë¯¸ì§€ ë¶„ë¥˜ ì„±ëŠ¥)")
    st.markdown("`f1`ì€ **ë†’ì„ìˆ˜ë¡** ì¢‹ìŠµë‹ˆë‹¤. (1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ìš°ìˆ˜)")
    
    df_acc = create_leaderboard_df(
        student_ids=student_ids,
        f1_dict=scores_f1,
        acc_dict=scores_acc,
        ascending=False  # ë†’ì€ ì ìˆ˜ê°€ ìœ„ë¡œ
    )
    # width='stretch'ë¡œ ì„¤ì •í•˜ì—¬ í‘œë¥¼ í˜ì´ì§€ ë„ˆë¹„ì— ë§ì¶¥ë‹ˆë‹¤. (ì´ì „ use_container_width=True ëŒ€ì²´)
    st.dataframe(df_acc, width='stretch')

# --- ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ---
if __name__ == "__main__":
    main()






